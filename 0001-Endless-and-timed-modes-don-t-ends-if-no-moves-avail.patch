From e8afe6d54035a2db73266ad0b0d25d713de609a3 Mon Sep 17 00:00:00 2001
From: Daniele Napolitano <dnax88@gmail.com>
Date: Sat, 2 Jul 2011 17:01:53 +0200
Subject: [PATCH 01/75] Endless and timed modes don't ends if no moves
 available (closes bug #779458)

---
 src/board_engine.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/board_engine.c b/src/board_engine.c
index e5a991e..3dc1f42 100644
--- a/src/board_engine.c
+++ b/src/board_engine.c
@@ -764,7 +764,7 @@ board_engine_loop (gpointer data)
 			gweled_gems_fall_into_place (FALSE);
 		} else {
 			if (gweled_check_for_moves_left (NULL, NULL) == FALSE) {
-				if ((gi_next_bonus_at == FIRST_BONUS_AT) && (prefs.game_mode != ENDLESS_MODE)) {
+				if ((gi_level == 1) || (prefs.game_mode == ENDLESS_MODE) || (prefs.game_mode == TIMED_MODE)) {
 					gint i, j;
                     // TRANSLATORS: # is replaced with !!
 					gweled_draw_game_message ("no moves left #", 1);
@@ -792,6 +792,7 @@ board_engine_loop (gpointer data)
 					gweled_gems_fall_into_place (FALSE);
 					gi_state = _MARK_ALIGNED_GEMS;
 				} else {
+				    // Game over
 					gweled_draw_message ("no moves left #");
 					gi_game_running = 0;
 					score.plain = gi_score;
-- 
2.33.1

